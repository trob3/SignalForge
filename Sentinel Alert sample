def test_sample_csv_scores():
    """Regression test against the canonical Sentinel Alert sample."""
    df = pd.read_csv("tests/fixtures/sentinel_alert_sample.csv")
    norm = normalize_alerts_df(df)
    result = score_detections(norm)
    scores = {r.rule_name: r.detection_quality_score for r in result.per_rule}

    assert scores["Port Scan Detected"]     <  40.0   # P0
    assert scores["Impossible Travel"]      <  65.0   # P1
    assert scores["Suspicious OAuth App"]   >  90.0   # P3
    assert result.lowest_scores[0].rule_name == "Port Scan Detected"
    assert result.highest_scores[0].rule_name == "Suspicious OAuth App"
